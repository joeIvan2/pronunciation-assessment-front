# 登入Modal功能說明

## 📋 功能概述

當未登入的使用者嘗試執行需要登入的操作時，系統會自動彈出登入提示Modal，引導使用者登入以享受完整功能。

## 🔧 觸發登入Modal的操作

### 1. 加入我的最愛
- **觸發時機**: 點擊收藏按鈕（⭐）時
- **提示訊息**: "將句子加入我的最愛需要登入，這樣您就可以在不同裝置間同步您的收藏。"
- **功能說明**: 登入後可在雲端儲存收藏，實現跨裝置同步

### 2. 新增標籤
- **觸發時機**: 嘗試新增自訂標籤時
- **提示訊息**: "新增自訂標籤需要登入，這樣您的標籤就可以在不同裝置間同步。"
- **功能說明**: 登入後可建立個人標籤系統，在不同裝置間保持一致

### 3. 數據分享
- **觸發時機**: 點擊"生成分享鏈接"按鈕時
- **提示訊息**: "分享您的收藏和標籤需要登入，這樣可以記錄您的分享歷史並提供編輯功能。"
- **功能說明**: 登入後可記錄分享歷史，並獲得編輯分享內容的權限

## 🎨 Modal設計特色

### 視覺設計
- **現代化UI**: 圓角設計、陰影效果、漸變動畫
- **響應式佈局**: 支援桌面、平板、手機等不同螢幕尺寸
- **品牌一致性**: 使用Google登入按鈕，保持設計統一

### 互動體驗
- **淡入動畫**: Modal出現時有平滑的淡入效果
- **點擊外部關閉**: 點擊Modal外部區域可關閉
- **關閉按鈕**: 右上角提供明確的關閉按鈕
- **鍵盤友好**: 支援ESC鍵關閉（可擴展）

### 內容結構
1. **標題**: "需要登入"
2. **圖示**: 雲端上傳圖示，象徵資料同步
3. **主要訊息**: 針對不同操作的客製化說明
4. **功能列表**: 登入後可享受的功能清單
   - 在雲端儲存您的收藏
   - 同步自訂標籤
   - 儲存分享記錄
   - 在不同裝置間同步資料
5. **操作按鈕**: 
   - "暫不登入"（次要按鈕）
   - "使用Google登入"（主要按鈕）

## 🔄 登入後的資料同步

### 收藏同步
- **載入**: 登入時自動載入雲端收藏
- **儲存**: 收藏變更時自動同步到雲端
- **合併策略**: 優先使用雲端資料，本地資料作為備份

### 標籤同步
- **載入**: 登入時自動載入雲端標籤
- **儲存**: 標籤變更時自動同步到雲端
- **ID管理**: 自動計算下一個可用的標籤ID

### 分享歷史
- **記錄**: 每次分享都會記錄到使用者資料中
- **包含資訊**: 分享ID、編輯密碼、創建時間
- **用途**: 方便使用者管理和編輯之前的分享

## 🛠️ 技術實作

### 元件結構
```
LoginModal.tsx          # Modal元件
├── LoginModal.css      # 樣式檔案
└── 整合到主頁面        # PronunciationAssessment.tsx
```

### 狀態管理
```typescript
const [showLoginModal, setShowLoginModal] = useState<boolean>(false);
const [loginModalMessage, setLoginModalMessage] = useState<string>('');
const [loginModalAction, setLoginModalAction] = useState<string>('此功能');
```

### 檢查函式
```typescript
const checkLoginAndShowModal = (actionName: string, customMessage?: string): boolean => {
  if (!user) {
    setLoginModalAction(actionName);
    setLoginModalMessage(customMessage || '');
    setShowLoginModal(true);
    return false;
  }
  return true;
};
```

## 📱 響應式設計

### 桌面版 (≥480px)
- Modal寬度: 最大480px
- 按鈕佈局: 水平排列
- 間距: 標準間距

### 手機版 (<480px)
- Modal寬度: 全寬度（留邊距）
- 按鈕佈局: 垂直堆疊
- 間距: 緊湊間距
- 字體: 適當縮小

## 🎯 使用者體驗優化

### 情境化訊息
- 每個操作都有專門的說明文字
- 強調登入後的具體好處
- 避免通用的登入提示

### 非強制性
- 提供"暫不登入"選項
- 不阻止使用者繼續使用基本功能
- 漸進式功能引導

### 即時回饋
- 登入成功後自動關閉Modal
- 登入失敗時顯示錯誤訊息
- 載入狀態的視覺回饋

## 🔮 未來擴展

### 可能的改進
1. **記住選擇**: 記住使用者的"暫不登入"選擇
2. **更多觸發點**: 在其他需要登入的功能中使用
3. **社交登入**: 支援更多登入方式（Facebook、Apple等）
4. **離線提示**: 網路斷線時的特殊處理
5. **資料遷移**: 本地資料到雲端的遷移助手

### 分析追蹤
- 追蹤Modal顯示次數
- 分析轉換率（顯示→登入）
- 了解使用者最常在哪個功能點登入

## 📊 測試覆蓋

### 自動化測試
- ✅ Modal觸發檢測
- ✅ Modal內容驗證
- ✅ 關閉功能測試
- ✅ 響應式佈局測試

### 手動測試建議
1. 測試所有觸發點
2. 驗證不同螢幕尺寸
3. 檢查登入流程
4. 確認資料同步
5. 測試錯誤處理 