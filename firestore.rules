rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 分享數據規則 - 允許任何人讀取和創建，但只有知道編輯密碼的人可以更新
    match /sharedData/{shareId} {
      // 允許任何人讀取分享的數據
      allow read: if true;
      // 允許任何人創建新的分享數據
      allow create: if true;
      // 只有提供正確編輯密碼的請求可以更新數據
      allow update: if request.auth != null;
      // 允許刪除（可能需要額外驗證）
      allow delete: if request.auth != null;
    }

    // 使用者個人數據規則 - 只有登入的使用者可以存取自己的數據
    match /users/{userId} {
      // 只有該使用者本人可以讀寫自己的文檔
      allow read, write: if request.auth != null && request.auth.uid == userId;
      
      // 使用者收藏子集合
      match /favorites/{favoriteId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
      
      // 使用者標籤子集合
      match /tags/{tagId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
    }

    // 如果有其他集合需要公開讀取（例如預設句子庫），可以在這裡添加
    // 預設情況下拒絕所有其他存取
  }
} 